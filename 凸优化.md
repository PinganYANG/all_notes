## 凸优化

#### 0.引言

##### 0.1 优化/数学规划 optimization/mathematical programming

从一个可行解的集合当中寻找出来的所有元素
$$
minimize\  f_0(x)\newline
subject\ to\ f_i(x)\leq b_i, i = 1,...,M
\newline
$$
$ x = [x^q,...,x^M]^T \ optimization \ variable$

$f_0: R^n \rightarrow R \ objective \ function$

$f_i: R^n \rightarrow R \ inequality\ function$

优化的目的是找到最优的$X^* \ optimal \leftrightarrow \forall z, z \isin \{f_i(z) \leq b_i,i = 1,...m \} and f_0(z) \leq f_0(x^*)$

$ z \isin \{f_i(z) \leq b_i,i = 1,...m \}$ 表示一个可行解集合



###### 例子：数据拟合问题

一个拟合二次函数的拟合问题，对于类似 $y=ax^2+bx+c$ 问题即：

$min  \ \ \epsilon_1^2 + ...+\epsilon_n^2 $，$\epsilon_i=y_i-ax_i^2+bx_i+c$



###### 例子：线性二次调节器LQR问题

$X_K = AX_{K-1} + B\times u_K$ (控制系统的一个内容) $A$ 是【状态转移矩阵】，$B$是【输入矩阵】,$u_K$是【输入】，$X$ 是状态

$\underset{u}{\min} \ J = \sum^N_{K=1}{(X_K^T QX_K+u^T_KRu_K)}$

最小化这些量的和，第一项$X_K^T QX_K$表示，Q是I矩阵时，相当于状态的方差，要让目标的方差最小

第二项$u^T_KRu_K$是输入的方差，要让输入的能量最小。因此要让输入的能量有限来控制系统。



###### 例子：多用户的能量控制问题

假设在一个三维空间内，有很多发送者$T_x$和接受者$R_x$,一对发送者和接受者成为一个用户。在空间中有大量的用户，即为$u_i$。每个用户以能量$P_i$发送信号。且能量非负并有上限$0\leq P\leq b_i$

一个用户的能量会对另一个用户产生干扰$\alpha_{ij}$,i对j的干扰

高斯噪声为$\delta^2$

SINR 信干噪比:

$SINR_i = \frac{P_i}{\delta^2_i+\sum_{j\neq i}{\alpha_{ji}P_i}}$

用户的信道容量 $f_i$ 正比于$log(1+SINR_i)$

这样有优化问题:

$max \sum_{i=1}^M f_i$

$subject\ to\ 0\leq P\leq b_i$





###### 例子：图像处理问题

二维图形$\Phi_0(x,y)$ 是一个带噪声的图像，希望恢复为一个不带噪声的图像 $\Phi(x,y)$ 

如果没有任何先验知识的情况下，其实很难分离出来这么多的先验知识。但我们知道自然图像一般是有规律的。

那么我们规定一个TV范数 $Total \ Variation (TV)$，图像在TV范数下是分辨光滑的。

$||\Phi||_{TV} = \sum_y{\sum_x{\sqrt{(\Phi(x,y) - \Phi(x,y-1))^2+(\Phi(x,y) - \Phi(x-1,y))^2}}} $

目的是求：

$\underset{\Phi}{\min} \ ||\Phi||_{TV} + \lambda ||\Phi - \Phi_0||^2_F$

后一项相当于正则化。其中后一项是F范数，表示矩阵所有元素的平方加和再开根号。



###### 例子：超大规模集成电路设计

门电路集合$\{g_1,...,g_n\}$

要把门电路连接成一个有向图，并使得系统能完成一定功能，且系统可以达到一些性能指标（比如能耗最小等等）【典型的OR问题】

那么可能的链接有 $\{t_1,...,t_n\}$

那么我们有

$max \ P(x)$

$st \ x \isin \{t1,...,t_n\}$



###### 例子：最短路径问题【典，是真的典】

一个无向图 $\{v_1,...,vn\}$，每个边都有一个权重$\{w_1,...,w_n\}$，给一个起点，找到终点的最短路径。

这样的问题可以写作，E是边
$$
min \ \sum_{i,j \isin E}{w_{ij}x_{ij}}
\newline
s.t. x_{ij} = 0,1
\newline
s.t. \ \sum_j{x_{ij}} -\sum_j{x_{ji}}=  
\begin{equation}
\left\{ 
\begin{array}{lr}
1, i=S \\
-1, i = D\\
0\ otherwise
\end{array} 
\right.
\end{equation}
$$


S,D保证起点终点。使得【终点\起点】只有一条线链接，只有进或出。其他点链接两条，有进出。



##### 0.2 线性规划/非线性规划

###### 线性规划

对于函数$f_i(\alpha x + \beta y) = \alpha f_i(x) + \beta f_i(y) \forall i =0,1,...,m$，这就是一个线性函数【线性可分性】

对于优化问题：
$$
minimize\  f_0(x)\newline
subject\ to\ f_i(x)\leq b_i, i = 1,...,M
\newline
$$
约束中的所有的f都是线性函数，那么就是一个线性规划问题。

线性规划问题的**最优解一定在定点或边上**



###### 非线性规划

对于以上优化问题，有一个或多个约束非线性，则是非线性规划



##### 0.3 凸规划/非凸规划

###### 凸规划

函数满足$f_i(\alpha x + \beta y) \leq \alpha f_i(x) + \beta f_i(y) \forall i =0,1,...,m$，则是一个**凸函数**

凸规划问题中的

- 可行解集要是一个凸集

- 目标函数时一个凸函数



【二次曲线就是一个凸函数

凸规划比非凸规划更好解决

##### 0.4 光滑/非光滑

主要针对目标函数$f_0(x)$ 而言的。光滑就处处可微的。

##### 0.5 连续/离散

主要针对可行域而言。

可行域是：

- 连续的
- 离散的【一些格点/整数 整数规划



##### 0.6 单目标/多目标

多目标时可能无法同时满足两个最优。

那么要用一个**帕累托曲线 pareto front** 来找一个**帕累托最优**

一般可以：

- 通过加权来将多目标转化为单目标问题。



求解一些非线性问题可以转化为相应的非线性优化问题

$f(x) > 0 \ \ \rightarrow \ min\ f^2(x)$



##### 0.7 一些优化领域的历史

##### 【略 



#### 1.仿射/凸/凸锥 + 集/组合/包 Convex set

鉴于最优化问题就是从可行域中找到问题的最优解，可以化成如下问题形式：
$$
minimize\  f_0(x)\newline
subject\ to\ f_i(x)\leq b_i, i = 1,...,M
\newline
x = [x_1,...,x_n]^T
$$

##### 1.1 仿射集 Affine sets

对于**直线**

$ x_1 \neq x_2 \isin R^n, \ \theta \isin R$

$y = \theta x_1 + (1-\theta)x_2 = x_2 + \theta(x_1 - x_2)$

对于**线段**

$ x_1 \neq x_2 \isin R^n, \ \theta \isin [0,1]$

$y = \theta x_1 + (1-\theta)x_2 = x_2 + \theta(x_1 - x_2)\ \ $



###### 1.1.1 定义

**仿射集**（简单定义）：一个集合C是仿射集，若$\forall x_1,\ x_2 \isin C$ 则链接$x_1$与$x_2$的直线也在集合内

数学形式： $x_1,x_2 \ \isin \ C, \ C是仿射集\ , \  \theta x_1 + (1-\theta)x_2 \isin C$

**泛化定义**：如果一个集合是一个仿射集，那么所有的仿射组合也一定属于这个仿射集

数学形式：

设 $x_1,...,x_k \isin C, \theta_1,...,\theta_k \isin R, \ \theta_1+...+\theta_k = 1$

###### 1.1.2 仿射组合

仿射组合有： $\theta_1 x_1 + ... + \theta_k x_k $ 【一个点

- 如果一个集合是一个仿射集，那么所有的放射组合也一定属于这个仿射集，即：

$\theta_1 x_1 + ... + \theta_k x_k \isin C$ 【如果k等于2，那么这个定义退化为上面的定义



**证明**：

有仿射集$C, x_1,x_2,x_3 \isin C$

有$\theta_1, \theta_2,\theta_3 \isin R \ and \ \theta_1 + \theta_2 + \theta_3 = 1$

则有：

$\frac{\theta_1}{\theta_1+\theta_2}x_1 +\frac{\theta_2}{\theta_1+\theta_2}x_2 \ \ \isin C$

则有：
$$
(\theta_1+\theta_2)(\frac{\theta_1}{\theta_1+\theta_2}x_1 +\frac{\theta_2}{\theta_1+\theta_2}x_2) + (1-\theta_1-

\theta_2 )x_3 \isin C
$$
展开得：

$\theta_1 x_1+\theta_2 x_2+\theta_3 x_3 \ \isin \ C$

进而推广可以证明。



可以看到，从简单定义可以推到泛化定义，同时也可以反推。





【所有点直线扩展出来的所有集合都是仿射集】



- 一条直线一定是仿射集

- 一个线段不是



###### 1.1.3 性质

有定义：

$x_1,x_2 \ \isin \ C, \ C是仿射集\ , \  \theta x_1 + (1-\theta)x_2 \isin C$

那么

$\alpha x_1+ \beta x_2 , \alpha,\beta \isin R 是否属于C?$

答： 除非$\alpha + \beta = 1$

那么是否存在有特殊情况来满足这种普遍性质呢？

当然有！【相当于把C平移了$x_0$
$$
V = C - x_0 = \{ x - x_0|x\isin C,\forall x_0 \isin C\}
$$
在这种条件下，我们称$V$为和$C$相关的子空间。

有：

- $V$是一个仿射集
- $V$满足$\alpha x_1+ \beta x_2 \isin V , \alpha,\beta \isin R $
- 这个子空间一定要经过原点

证明 $\forall V_1,V_2 \isin V,\forall \alpha, \beta \isin R \rightarrow \alpha V_1+ \beta V_2 \isin V$：
$$
\alpha V_1+ \beta V_2 + x_0 \isin C

\newline
\because \alpha(V_1+x_0)\isin C,\alpha(V_2+x_0) \isin C,(1-\alpha-\beta)x_0 \isin C
\newline
\therefore \alpha(V_1+x_0) +\alpha(V_2+x_0) +(1-\alpha-\beta)x_0 \isin C
$$


###### 例子： 线性方程组的解集是仿射集 【重要！！】【反过来也对】

有线性方程组的解集：
$$
C = \{x|Ax=b\},A \isin R^{m\times n},b \isin R^{m},x \isin R^{n}
$$
证明C是仿射集

证明：
$$
\forall x_1,x_2 \isin C, Ax_1 = b, Ax_2 = b
，
\theta \isin R

\newline
A(\theta x_1 + (1-\theta)x_2) = \theta A x_1 + (1-\theta)Ax_2 = b
\newline
\therefore \theta x1 +(1-\theta)x_2 \isin C
$$

$$
V =  \{ x - x_0|x\isin C\},\forall x_0 \isin C
\newline
=\{x - x_0|Ax = b\}, Ax_0 = b
\newline
=\{x - x_0|A(x-x_0) = 0\}
\newline
=\{y|Ay=0\}
$$

$\{y|Ay=0\}$这一关于y集合也被称为A的零空间。





##### 1.2 仿射包 aff c

给定任意集合C，C不一定是仿射集，那么如何在C上构造一个最小仿射集？

定义：
$$
aff \ C = \{\theta_1 x_1 + ... + \theta_k x_k |\forall x_1,...,x_k \isin C,\forall \theta_1+...+\theta_k =1\}
$$
就是在C中任意选择k个点，对其进行仿射组合，就可以得到一个**仿射包**的集合

- 空间内两点的**仿射包**就是两点之间的直线
- 空间内不共线3点的**仿射包**就是整个平面
- 仿射集的仿射包就是仿射集本身



##### 1.3 凸集 convex set

###### 1.3.1定义

一个集合C是凸集，当任意两点之间的线段仍然在C内。【相当于为仿射集的约束加上$1>=\theta_i>=0$?

数学定义：

$C为凸集 \leftrightarrow \ \theta x_1 +(1-\theta)x_2, \forall x_1,x_2 \isin C, \forall \theta, \theta \isin [0,1] \ \ $

可以说，仿射集就是凸集的特例。

##### 1.4 凸组合 

数学形式：

设 $x_1,...,x_k \isin C, \theta_1,...,\theta_k \isin R, \ \theta_1+...+\theta_k = 1,\theta_i\isin[0,1]$

凸组合有： $\theta_1 x_1 + ... + \theta_k x_k $ 

【类比于仿射组合，只多加了$\theta_i\isin[0,1]$的限制条件】



- 任意的一个集合C如果是凸集，那么从凸集中选取任意K个点的凸组合也仍然是凸集【对应于仿射集的这个定义



##### 1.5 凸包 Conv c

定义：

给定任意集合C，C不一定是凸集，那么凸包为：
$$
Conv \ C = \{\theta_1 x_1 + ... + \theta_k x_k |\forall x_1,...,x_k \isin C, \theta_1+...+\theta_k  =1,\forall \theta_1,...,\theta_k \isin [0,1]\}
$$
【相当于说是把C中任意两点连接成线段，任意多点向内线性组合】

- 甜甜圈不是凸集，但其凸包为一个圆面
- 离散格点的凸包则是最小凸的包络线

##### 1.6 锥 cone 凸锥 convex cone

###### 1.6.1 锥的定义：

$C是锥 \leftrightarrow \forall x \isin C, \theta \ge0 有 \theta x \isin C$

###### 1.6.2 凸锥的定义：

$C是凸锥 \leftrightarrow \forall x_1,x_2 \isin C; \theta_1,\theta_2 \ge0; 有 \theta_1 x_1 +\theta_2 x_2 \isin C$

 【非负约束有点仅向外扩张的感觉

**【凸锥一定经过原点】**



##### 1.7 凸锥组合

数学形式：

设 $x_1,...,x_k \isin C, \theta_1,...,\theta_k \isin R, \ \theta_1,...,\theta_k \ge 0$

凸锥组合有： $\theta_1 x_1 + ... + \theta_k x_k $ 



##### 1.8 凸锥包

$$
 \{\theta_1 x_1 + ... + \theta_k x_k |\forall x_1,...,x_k \isin C,\forall \theta_1,...,\theta_k \ge 0\}
$$

![img](https://pic1.zhimg.com/80/v2-452015b19f480841e184728d6cab4e6c_720w.webp)

##### 1.9 三种组合比较

$仿射组合\ \ \ \forall \theta_1,...,\theta_k,\theta_1+...+\theta_k  =1$

$凸组合\ \ \ \forall \theta_1,...,\theta_k,\theta_1+...+\theta_k  =1,\forall \theta_1,...,\theta_k \isin [0,1]$

$凸锥组合\ \ \ \forall \theta_1,...,\theta_k,\theta_1,...,\theta_k \ge 0$



任意的仿射集一定是凸的，任意一个仿射组合在集合内的话，那么他的凸组合也一定在集合内。那么仿射组合就是凸组合的一个特例。

同理，凸锥组合也是凸组合的一个特例。



以上的定义有一个小问题，就是都假定了有两个点。而可以把这个定义扩充到单点。**任意的一个单点一定是仿射集，一定是凸集，但并不是凸锥，除非其在原点。**



**而空集既是仿射集，又是凸集，也是凸锥**
